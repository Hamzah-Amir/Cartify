{% extends "base.html" %}

{% block title %}Checkout{% endblock title %}

{% load static %}

{% block extra_head %}
<link rel="stylesheet" href="{% static "cart/process_checkout.css" %}">
{% endblock extra_head %}

{% block body %}
<div class="checkout-container">
    <h1 class="checkout-heading">Checkout</h1>
    
    <div class="checkout-content">
        <!-- Payment Method Section -->
        <div class="payment-section">
            <h2 class="section-title">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="2" y="5" width="20" height="14" rx="2"/><path d="M2 10h20"/>
                </svg>
                Payment Method
            </h2>
            
            <div class="payment-options">
                <!-- Credit/Debit Card -->
                <label class="payment-option">
                    <input type="radio" name="payment_method" value="card" checked>
                    <div class="payment-content">
                        <div class="payment-method">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="2" y="5" width="20" height="14" rx="2"/><path d="M2 10h20"/>
                            </svg>
                            Credit / Debit Card
                        </div>
                        <div class="payment-subtitle">Powered by Stripe</div>
                    </div>
                </label>

                <!-- Cash on Delivery -->
                <label class="payment-option">
                    <input type="radio" name="payment_method" value="cash_on_delivery">
                    <div class="payment-content">
                        <div class="payment-method">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="1"/><path d="M12 1v6m0 6v6M4.22 4.22l4.24 4.24m5.08 5.08l4.24 4.24M1 12h6m6 0h6M4.22 19.78l4.24-4.24m5.08-5.08l4.24-4.24"/>
                            </svg>
                            Cash on Delivery
                        </div>
                        <div class="payment-subtitle">Pay on delivery</div>
                    </div>
                </label>
            </div>

            <div class="checkout-actions">
                <a href="{% url 'checkout' %}" class="btn-back">Back</a>
                {% if orders %}
                {% for order in orders %}
                <a href="{% url "order_detail" order.id %}">
                    <button class="btn-review">Review Order â†’</button>
                </a>
                {% endfor %}
                {% endif %}
            </div>
        </div>

        <!-- Order Summary Section -->
        <div class="order-summary-section">
            <h2 class="summary-title">Order Summary</h2>
            
            {% if orders %}
                {% for order in orders %}
                <div class="order-group">
                    <div class="seller-info">
                        <span class="seller-label">Sold by:</span>
                        <span class="seller-name">{{ order.items.first.product.seller.username }}</span>
                    </div>
                    
                    <div class="summary-items">
                        {% for item in order.items.all %}
                        <div class="summary-item">
                            <div class="item-details">
                                <span class="item-name">{{ item.product.name }}</span>
                                <span class="item-qty">x{{ item.quantity }}</span>
                            </div>
                            <span class="item-price">PKR {{ item.price }}</span>
                        </div>
                        {% endfor %}
                    </div>

                    <div class="summary-divider"></div>

                    <div class="summary-row">
                        <span>Subtotal</span>
                        <span class="summary-value">PKR {{ order.total_price }}</span>
                    </div>

                    <div class="summary-row">
                        <span>Delivery Fee</span>
                        <span class="summary-value">PKR {{ order.delivery_fee }}</span>
                    </div>

                    <div class="summary-divider"></div>

                    <div class="summary-total">
                        <span>Total</span>
                        <span class="total-amount">PKR {{ order.total_price|add:order.delivery_fee }}</span>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="summary-item">
                    <span class="item-name">No orders</span>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<script>
    // Handle payment method selection
    document.querySelectorAll('input[name="payment_method"]').forEach(radio => {
        radio.addEventListener('change', function() {
            console.log('Selected payment method:', this.value);
        });
    });
</script>
{% endblock body %}