{% extends "base.html" %}
{% block title %}Order Details{% endblock title %}

{% load static %}

{% block extra_head %}
<link rel="stylesheet" href="{% static "cart/order_detail.css" %}">
{% endblock extra_head %}

{% block body %}
<div class="checkout-container">
    <h1 class="checkout-heading">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 11l3 3L22 4"/><path d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        Order Review
    </h1>
    
    <div class="checkout-content">
        <!-- Left Section - Order Details -->
        <div class="order-details-section">
            <!-- Shipping Information -->
            <div class="detail-card">
                <h2 class="card-title">Shipping Information</h2>
                
                <div class="info-group">
                    <div class="info-row">
                        <span class="info-label">Name:</span>
                        <span class="info-value">{{ order.user.first_name }} {{ order.user.last_name }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Email:</span>
                        <span class="info-value">{{ order.user.email }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Address:</span>
                        <span class="info-value">{{ order.user.address }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">City:</span>
                        <span class="info-value">{{ order.user.city }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">State:</span>
                        <span class="info-value">{{ order.user.state }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Postal Code:</span>
                        <span class="info-value">{{ order.user.postal_code }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Phone:</span>
                        <span class="info-value">{{ order.user.phone_number }}</span>
                    </div>
                </div>
                <a href="#" class="edit-link">Edit</a>
            </div>

            <!-- Payment Method -->
            <div class="detail-card">
                <h2 class="card-title">Payment Method</h2>
                <div class="payment-display">
                    <span class="payment-value">{{ order.status|upper }}</span>
                </div>
                <a href="#" class="edit-link">Edit</a>
            </div>

            <!-- Order Items -->
            <div class="detail-card">
                <h2 class="card-title">Order Items</h2>
                
                <div class="order-items-list">
                    {% for item in order_items %}
                    <div class="order-item">
                        <div class="item-image">
                            <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}">
                        </div>
                        <div class="item-info">
                            <h3 class="item-title">{{ item.product.name }}</h3>
                            <p class="item-qty">Quantity: {{ item.quantity }}</p>
                        </div>
                        <div class="item-price">PKR {{ item.price }}</div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <a href="{% url 'process_checkout' %}" class="btn-back">Back</a>
                <button class="btn-place-order">Place Order</button>
            </div>
        </div>

        <!-- Right Section - Order Summary -->
        <div class="order-summary-section">
            <h2 class="summary-title">Order Summary</h2>
            
            <div class="summary-items">
                {% for item in order_items %}
                <div class="summary-item">
                    <div class="item-details">
                        <span class="item-name">{{ item.product.name }}</span>
                        <span class="item-qty">x{{ item.quantity }}</span>
                    </div>
                    <span class="item-price">PKR {{ item.price }}</span>
                </div>
                {% endfor %}
            </div>

            <div class="summary-divider"></div>

            <div class="summary-row">
                <span>Subtotal</span>
                <span class="summary-value">PKR {{ order.total_price }}</span>
            </div>

            <div class="summary-row">
                <span>Tax (8%)</span>
                <span class="summary-value">PKR {{ order.total_price|add:0|add:0 }}</span>
            </div>

            <div class="summary-divider"></div>

            <div class="summary-total">
                <span>Total</span>
                <span class="total-amount">PKR {{ order.total_price }}</span>
            </div>
        </div>
    </div>
</div>

<script>
    document.querySelector('.btn-place-order').addEventListener('click', function() {
        alert('Order placed successfully!');
        window.location.href = "{% url 'home' %}";
    });
</script>
{% endblock body %}